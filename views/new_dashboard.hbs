<link rel="stylesheet" href="/stylesheets/Main.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
<link rel="stylesheet" href="/stylesheets/home.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<style>

h2 {
  color: rgb(15, 15, 15);
  padding: 2rem 0;
}
.card {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
  transition: 0.3s;
  border: none;
  text-align: center;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  &:hover {
    box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.4);
  }
  a {
    color: initial;
    &:hover {
      text-decoration: initial;
    }
  }
  .text-muted i {
    margin: 0 10px;
  }
}
.card img{
  height: 300px;
  width: 100%;
}

.btn-btn-background{
    -moz-user-select:none;
    background-image: -webkit-linear-gradient(145deg ,#faa61f 0% , #faa61f 0% , #ed1847 100%);
    border:1px solid #bfa67a;
    border-radius: 0.5rem;
    color:#ffffff;
    cursor:pointer;
    display: inline-block;
    font-size:12px;
    line-height: 1.42857;
    margin-bottom:0;
    padding:12px 0px;
    text-align:center;
    text-transform:uppercase;
    transition:all 0.5s ease 0s;
    vertical-align: middle;
    padding:15px;
    
  
  }
  .btn-btn-background:hover{
    text-decoration: none;
    color:#272627;
    background:white;
  }
  input{
    background: rgba(255,255,255,0.1);
    border-radius: 0.6rem;
    border-style: none;
    text-align: center;
    width: 100%;
  }
</style>

<section id="section1">
<!-- Nav  Bar Start-->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup">
       <span class="navbar-toggler-icon"></span>
    </button>
    <div class="brand">
      <a href="#" class="navbar-left">
        <object type="image/svg+xml" data="/svg/logo.svg"   class="logo-image"></object>
      </a>
      <a class="navbar-brand " href="http://localhost:{{port}}/">MakaanTipTop</a>
    </div>
    <div class="Alt">


    <div class="collapse navbar-collapse menu" id="navbarNavAltMarkup">
       <ul class="navbar-nav ml-auto">
          <li class="nav-item space">
             <a class="nav-item nav-link active"  href="http://localhost:{{port}}/dashboard">Home <span class="sr-only"></span></a>
          </li>
          <li class="nav-item space">
             <a class="nav-item nav-link  " href="http://localhost:{{port}}/adopt_services">Services</a>
          </li>
          <li class="nav-item st">
             <a class="nav-item nav-link " href="#" style="color:#fea116"><i class="fas fa-store" style="margin-right:5px"></i>Store</a>
          </li>
        </ul>
        </div>
      </div>

      <div class="btn-group">
      <div class="collapse navbar-collapse">
              <ul class="navbar-nav">
                <li class="nav-item ">
                  <a href="#" class="dropdown dropdown-toggle"  data-toggle="dropdown">
                  <span title="Badal Joshi"><img src="/images/face.png" class="img-fluid section1_image1"  alt="#"></span><span class="caret"></span></a>
                  <ul class="dropdown-menu pull-left">
                  <div class="square"></div>
                    <li>
                      <div class="user">

                        <a href="#" style="color:black"><i class="fas fa-user"></i><strong id = "username"></strong></a>
                        <hr />
                      </div>
                    </li>
                    <li class="account" ><a href="#" style="color: #010414" >Profile</a></li>
                    <li class="account"><a href="#" style="color: #010414" >Update Details</a></li>
                    <li class= "account"><a href="#" style="color:#e6514c" onclick="logout()">Sign Out</a></li>
                  </ul>
                </li>
              </ul>
      </div>
      </div>
   </nav>
<!-- Nav Bar End-->
</section>
<div class="container">
  <div class="text-center">
    <h2>Pick a Service</h2>
  </div>
  
  <div class="container">
    <div class="card-columns">
      <div class="card">        
        <div class="card-body">
          <h5 class="card-title">Click below to see active services</h5>
          <p class="card-text">
            <form method = "GET" action="http://localhost:3000/adopt_services/current_services" >
              <div class="form-group">
              <i class = "fa fa-user"></i><input type="text" class=''name = 'username' id = 'name' disabled>
              </div>
              <div class="form-group">
              <i class="fa fa-envelope"></i><input class = ''type="text" name = 'email' id = 'email' disabled>
              </div>
              <input type="submit" class='btn-btn-background' value = 'Active Services'>
            </form>
          </p>
        </div>
      </div>
      <div class="card">
        <a href="http://localhost:{{port}}/adopt_services/superMaid">
        <img class="card-img-top" src="/images/Workers/Maid.jpg"alt="Card image cap">
        <div class="card-body">
          <h5 class="card-title">Super Maid</h5>
          <p class="card-text">
            Are you too tired of house works?<br> Need a hand?<br> Get a maid and take a break.
          </p>
        </div>
        </a>
      </div>
      <div class="card">
        <a href="http://localhost:{{port}}/adopt_services/delivery">
        <img class="card-img-top" src="/images/Workers/delivery.jpg" alt="Card image cap">
        <div class="card-body">
          <h5 class="card-title">Delivery</h5>
          <p class="card-text">Feeling lazy or busy?<br> Can't go to pick the orders?<br> Waana send someone for it?<br> Worry not We got your back.</p>
        </div>
        </a>
      </div>
      <div class="card">
        <a href="http://localhost:{{port}}/adopt_services/electrician">
        <img class="card-img-top" src="/images/Workers/Elec.png" alt="Card image cap">
        <div class="card-body">
          <h5 class="card-title">Electrician</h5>
          <p class="card-text">
            Fuse Blown No light?<br> Electricity issues?<br> Dont worry! <br> You are just a click away
          </p>
        </div>
        </a>
      </div>
      <div class="card">
        <a href="http://localhost:{{port}}/adopt_services/plumber">
        <img class="card-img-top" src="/images/Workers/Plumber.jpg" alt="Card image cap">
        <div class="card-body">
          <h5 class="card-title">Plumber</h5>
          <p class="card-text">Water leakage?<br> Taps not working?<br> We will find a right person.</p>
        </div>
        </a>
      </div>
      <div class="card">
        <a href="http://localhost:{{port}}/adopt_services/carpenter">
        <img class="card-img-top" src="/images/Workers/Carpenter.jpg" alt="Card image cap">
        <div class="card-body">
          <h5 class="card-title">Carpenter</h5>
          <p class="card-text"> 
            Want to have a nice furnitures?<br> Or something is broken?<br> We will fix it for you. Click here and relax!
          </p>
        </div>
        </a>
      </div>
      <div class="card">
        <a href="http://localhost:{{port}}/adopt_services/laundry">
        <img class="card-img-top" src="/images/Workers/Laundry.jpg" alt="Card image cap">
        <div class="card-body">
          <h5 class="card-title">Laundry</h5>
          <p class="card-text">Dirty clothes?
            Busy schedule?We will clean them as new.Just leave it to us.
          </p>
        </div>
        </a>
      </div>
    </div>
  </div>
</div>

<script>

  function profilerender(userData) {


  const { userDetails } = userData;
  var templateProfile = `<div class=" py-3">
                      <div class="container ">
                        <div class="row ">
                          <div class="col-md-4 text-dark">
                            <div class="my-5">
                              <h4> <i class="fa fa-user mx-2"></i>${ userData.name}</h4>
                              <h4><i class="fa fa-envelope mx-2"></i>${ userData.email}</h4>
                            </div>
                          </div>
                        </div>
                      </div>`
  $("#root").html(templateProfile)
  return 

  }


  function profile(){
    $.ajax({
      url: "http://localhost:3000/api/users/profile",
      type: 'GET',
      // Fetch the stored userToken from localStorage and set in the header
      headers: { "Authorization": window.localStorage.getItem('userToken') },
      success: function (data) {
        window.localStorage.setItem('profileData',JSON.stringify(data.user))
        profilerender(data.user)
      },
      error:function(response){
        alert("something went wrong")
    }
    });
  }

  $(document).ready(function(){
    if(!window.localStorage.user && !window.localStorage.token){
      alert("please login")
      window.location.href = `http://localhost:{{port}}/login`;
    }
    else{
      let user = window.localStorage.getItem('user');
      user = JSON.parse(user);
      let email = user.email;
      user = user.username;
      document.getElementById('username').textContent = user;
      document.getElementById('name').value = user;
      document.getElementById('email').value = email;
      profile()
    }
  })

  function logout(){
  window.localStorage.clear()
  window.location.href = "http://localhost:{{port}}/login";
  }
  
</script>